{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<header id="event" class="masthead text-center text-white">
  <div class="masthead-content">
    <div class="container">
      <div class="container mt-5">
        <div class="row user-menu-container square">
          <div class="col-md-7 user-details">
            <div class="row coralbg white">
              <div class="col-md-6 no-pad">
                <div class="user-pad">
                    <h3>Welcome back, {{user_profile.user.username}}</h3>
                    <h4 class="white"><i class="fa fa-check-circle-o"></i>{{user_profile.user.profile.location}}</h4>
                    <h4 class="white"><i class="fa fa-twitter"></i> Birthday: {{user_profile.user.profile.birth_date}}</h4>
                    <a type="button" class="btn btn-labeled btn-info" href="{% url 'profile-edit' %}">
                    <span class="btn-label"><i class="fa fa-pencil"></i></span>Update</a>
                </div>
              </div>
                <div class="col-md-6 ">
                    <div class="">
                      {% if user_profile.user.profile.profile_pic %}
                        
                        <img src="{{user_profile.user.profile.profile_pic.url}}" class="img-fluid my-4 border">
                      {% endif %}
                    </div>
                </div>
            </div>
              <div class="row overview">
                  <div class="col-md-4 user-pad text-center">
                      <h6 style="word-wrap: break-word; color:black;">FOLLOWERS</h6>
                      <h4 id="followers-{{user_profile.user.id}}"></h4>
                  </div>
                  <div class="col-md-4 user-pad text-center">
                      <h6 style="word-wrap: break-word; color:black;">FOLLOWING</h6>
                      <h4 >456</h4>
                  </div>
                  <div class="col-md-4 user-pad text-center">
                      <h6 style="word-wrap: break-word; color:black;">APPRECIATIONS</h6>
                      <h4>4,901</h4>
                  </div>
              </div>
          </div>
            <div class="col-md-1 user-menu-btns">
                <div class="btn-group-vertical square" id="responsive">
                    <a href="#" class="btn btn-block btn-default active">
                      <i class="fa fa-bell-o fa-3x"></i>
                    </a>
                    <a href="#" class="btn btn-default">
                      <i class="fa fa-envelope-o fa-3x"></i>
                    </a>
                    <a href="#" class="btn btn-default">
                      <i class="fa fa-laptop fa-3x"></i>
                    </a>
                    <a href="#" class="btn btn-default">
                      <i class="fa fa-cloud-upload fa-3x"></i>
                    </a>
                </div>
            </div>
            <div class="col-md-4 user-menu user-pad">
                <div class="user-menu-content active">
                    <h3>
                        Recent Events Attended
                    </h3>
                    <ul class="user-menu-list">
                      {% for recent_event in attendedevent_list  %}
                        <li>
                            <h4 style="word-wrap: break-word;"><i class="fa fa-user coral"></i> {{recent_event.event.title}}</h4>
                            <small class="text-muted">{{recent_event.event.date}}</small>
                        </li>
                        
                      {% endfor %}
                       <!-- <li>
                            <h4><i class="fa fa-heart-o coral"></i> {{attendedevent_list.1.event.title}}</h4>
                        </li>
                        <li>
                            <h4><i class="fa fa-paper-plane-o coral"></i> Gracie Jenkins followed you.</h4>
                        </li>-->
                        <li>
                            <button type="button" class="btn btn-labeled btn-success" href="#">
                                <span class="btn-label"><i class="fa fa-bell-o"></i></span>View all activity</button>
                        </li>
                    </ul>
                </div>
                <div class="user-menu-content">
                    <h3>
                          Bio
                    </h3>
                    <div class="border border-warning pb-5 rounded "><h6>{{user_profile.user.profile.bio}}</h6></div>
                </div>
                <div class="user-menu-content">
                    <h3>
                        Trending
                    </h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="view">
                                <div class="caption">
                                    <p>47LabsDesign</p>
                                    <a href="" rel="tooltip" title="Appreciate"><span class="fa fa-heart-o fa-2x"></span></a>
                                    <a href="" rel="tooltip" title="View"><span class="fa fa-search fa-2x"></span></a>
                                </div>
                                <img src="http://24.media.tumblr.com/273167b30c7af4437dcf14ed894b0768/tumblr_n5waxesawa1st5lhmo1_1280.jpg" class="img-fluid">
                            </div>
                            <div class="info">
                                <p class="small" style="text-overflow: ellipsis">An Awesome Title</p>
                                <p class="small coral text-right"><i class="fa fa-clock-o"></i> Posted Today | 10:42 A.M.</small>
                            </div>
                            <div class="stats turqbg">
                                <span class="fa fa-heart-o"> <strong>47</strong></span>
                                <span class="fa fa-eye pull-right"> <strong>137</strong></span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="view">
                                <div class="caption">
                                    <p>47LabsDesign</p>
                                    <a href="" rel="tooltip" title="Appreciate"><span class="fa fa-heart-o fa-2x"></span></a>
                                    <a href="" rel="tooltip" title="View"><span class="fa fa-search fa-2x"></span></a>
                                </div>
                                <img src="http://24.media.tumblr.com/282fadab7d782edce9debf3872c00ef1/tumblr_n3tswomqPS1st5lhmo1_1280.jpg" class="img-responsive asd">
                            </div>
                            <div class="info">
                                <p class="small" style="text-overflow: ellipsis">An Awesome Title</p>
                                <p class="small coral text-right"><i class="fa fa-clock-o"></i> Posted Today | 10:42 A.M.</small>
                            </div>
                            <div class="stats turqbg">
                                <span class="fa fa-heart-o"> <strong>47</strong></span>
                                <span class="fa fa-eye pull-right"> <strong>137</strong></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="user-menu-content">
                    <h2 class="text-center">
                        START SHARING
                    </h2>
                    <center><i class="fa fa-cloud-upload fa-4x"></i></center>
                    <div class="share-links">
                        <center><button type="button" class="btn btn-lg btn-labeled btn-success" onclick="follow({{user_profile.user.id}})"  style="margin-bottom: 15px;">
                                <span class="btn-label"><i class="fa fa-bell-o"></i></span>FOLLOW
                        </buttonsss></center>
                        <center>
                          <button type="button" class="btn btn-lg btn-labeled btn-warning" href="#">
                                <span class="btn-label"><i class="fa fa-bell-o"></i></span>A WORK IN PROGRESS
                          </button>
                        </center>
                    </div>
                </div>
            </div>
        </div>
      </div>
      
    <div id="accordion" >
            <div class="card" >
              <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                  <button class="btn btn-primary btn-lg btn-block" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    Events Made By {{user_profile.user.username}}
                  </button>
                </h5>
              </div>
              <div id="collapseOne" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
                <div class="table-responsive">
                  <table class="table table-striped"> 
                    <tr>
                      <th>Name</th>
                      <th>Description</th>
                      <th>Date</th>
                      <th>Seats</th>
                      <th></th>
                      <th></th>
                    </tr>
                   {% for event in events%}
                    <tr>
                      <td>{{event.title}}</td>
                      <td>{{event.description}}</td>
                      <td>{{event.date}}</td>
                      <td>{{event.seats}}</td>
                      {%if request.user == event.organizer  %}
                        <td><a href="{% url 'event-detail' event.id  %}" class="btn btn-outline-light">Details</a></td>
                         <td><a href="{% url 'event-edit' event.id  %}" class="btn btn-outline-light">Edit event</a></td>
                         {# <!-- <td><a href="{% url 'event-delete' classroom.id event.id  %}" class="btn btn-outline-danger">Delete event</a></td> --> #}
                       {% else %}
                       <td><a href="{% url 'event-booked' event.id  %}" class="btn btn-outline-light">Book event</a></td>
                      {%endif%}
                    </tr>
                  {%endfor%}
                </table>
                </div>
              </div>
            </div>
          </div>
   <!-- {%if request.user == event.organizer  %}
    <div class="jumbotron">
          <h2 class="masthead-subheading mb-0">Attendees</h2>
          <table class="table table-striped"> 
          <tr>
            <th>Name</th>
          </tr>
          {% for attendee in attendees  %}
            <tr>
            <td>{{attendee.user.username}}</td>
          </tr>
          {% endfor %}
        </table>
      </div>
    {% endif  %}-->
    </div>
  </div>
  <div class="bg-circle-1 bg-circle"></div>
  <div class="bg-circle-2 bg-circle"></div>
  <div class="bg-circle-3 bg-circle"></div>
  <div class="bg-circle-4 bg-circle"></div>
</header>

<script type="text/javascript">
    function follow(user_id){
        let count_id = "#followers-"+user_id
        $.ajax({
            type: "GET",
            url: '/profile/'+user_id+'/follow/',
            error: function(){
                alert("something went wrong")
            },
            success: function(data){
                if (data.action === "followed"){
                    $(count_id).text(data.f_Objs);
                }
            }
            
        })
    }
</script>
{% endblock %}